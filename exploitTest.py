
import sys
from PyQt5.QtWidgets import *
from PyQt5.QtCore import *
from PyQt5 import QtCore, QtGui, QtWidgets
from PyQt5.QtGui import *
from scanComputer import *
from scanNetworkVerbose import *
from scanNetwork import *
from PyQt5.QtWidgets import QWidget, QLabel, QApplication, QHBoxLayout, QPushButton, QVBoxLayout
from PyQt5 import QtWidgets as qtw
from PyQt5.QtWidgets import (
    QApplication, QWidget, QPushButton, QLabel, QLineEdit, QGridLayout, QMessageBox)
import csv
import os
from PyQt5.uic import loadUi
from fileinput import filename
from singleCompExploit import *
fileCreate = ""

class ExploitComputerWindow(QWidget):
    def __init__(self):
        super(ExploitComputerWindow, self).__init__()
        HLayout = QHBoxLayout()
        
        self.setWindowTitle("Exploit Computer")
        self.setFixedSize(400,300)
        self.labelTitle = QLabel("IP Address", self)
        self.labelTitle.move(15,110)
        self.labelTitle.setStyleSheet("font-size: 12px; font-weight: bold")
        self.labelTitle = QLabel("Select Port", self)
        self.labelTitle.move(225,110)
        self.labelTitle.setStyleSheet("font-size: 12px; font-weight: bold")
        self.labelTitle = QLabel("Select OS", self)
        self.labelTitle.move(310,110)
        self.labelTitle.setStyleSheet("font-size: 12px; font-weight: bold")        
        
        
        self.pushButtonSubmit = QPushButton("Exploit",self)
        self.pushButtonSubmit.setGeometry(275, 200, 100, 50)
        
        self.portDropDown = QComboBox(self)
        self.portDropDown.addItems(['','ftp','apache','samba','IRC','php','java','postgres'])
        
        self.OSDropDown = QComboBox(self)
        self.OSDropDown.addItems(['', 'windows', 'Linux'])
        
        self.textbox = QLineEdit()
        self.textbox.resize(280, 40)
        
        HLayout.addWidget(self.textbox)
        HLayout.addWidget(self.portDropDown)
        HLayout.addWidget(self.OSDropDown)
        
        self.setLayout(HLayout)
        self.pushButtonSubmit.clicked.connect(self.on_exploitClick)

    @pyqtSlot()
    def on_exploitClick(self):
        inputtedIPAddress = self.textbox.text()
        portSelected = self.portDropDown.currentText()
        OSSelected = self.OSDropDown.currentText()
        
        if(inputtedIPAddress == ""):
            QMessageBox.question(self, "No IP inputted", QMessageBox.Ok, QMessageBox.Ok)
            self.textbox.setText("")
            return 0;
        if(portSelected == ""):
            QMessageBox.question(self, "No Port selected", QMessageBox.Ok, QMessageBox.Ok)
            return 0;
        if(OSSelected == ""):
            QMessageBox.question(self, "No OS selected", QMessageBox.Ok, QMessageBox.Ok)
        
        #print(inputtedIPAddress)
        #print(portSelected)
        #print(OSSelected)
        exploitTest(inputtedIPAddress, portSelected, OSSelected)
        ExploitComputerWindow.hide()
                       
